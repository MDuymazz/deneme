name: Delete Files After Push (Manual or Workflow Trigger)

on:
  push:
    paths:
      - sil.txt  # Sadece `sil.txt` dosyası değiştiğinde çalışacak
  workflow_dispatch:  # Manuel olarak da tetiklenebilir

jobs:
  cleanup:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: List files in the repository (for debugging)
      run: |
        echo "Listing files in the root directory:"
        ls -alh
        echo "Listing files in the 'v' directory before deletion:"
        ls -alh ./v
        echo "Listing files in the 's' directory before deletion:"
        ls -alh ./s

    - name: Delete all files except data.html in the 'v' directory, ana_link.txt, and logo.txt, and delete sil.txt
      run: |
        echo "Deleting files in './v' directory except data.html"
        # v klasöründeki dosyaları listele
        ls -alh ./v
        
        # data.html hariç tüm dosyaları sil
        for file in ./v/*; do
          if [[ "$file" != "./v/data.html" ]]; then
            echo "Deleting file: $file"
            rm -f "$file"
          fi
        done

        # s klasöründeki ana_link.txt ve logo.txt hariç tüm dosyaları sil
        echo "Deleting files in './s' directory except ana_link.txt and logo.txt"
        for file in ./s/*; do
          if [[ "$file" != "./s/ana_link.txt" && "$file" != "./s/logo.txt" ]]; then
            echo "Deleting file: $file"
            rm -f "$file"
          fi
        done

        # Ana dizindeki sil.txt dosyasını sil
        echo "Deleting sil.txt in the root directory"
        rm -f ./sil.txt

    - name: List files after deletion (for debugging)
      run: |
        echo "Listing files in the root directory after deletion:"
        ls -alh
        echo "Listing files in the 'v' directory after deletion:"
        ls -alh ./v
        echo "Listing files in the 's' directory after deletion:"
        ls -alh ./s
